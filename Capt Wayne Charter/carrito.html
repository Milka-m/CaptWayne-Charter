<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Carrito | Capt. Wayne Charters</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;600;800&display=swap" rel="stylesheet" />
<style>
body {
  font-family: 'Outfit', sans-serif;
  background-image: url('https://media.istockphoto.com/id/184600243/photo/coral-reef-roatan-honduras.jpg?s=612x612&w=0&k=20&c=-tvn8IxjLPQnW-NWD2cqKaR7ZXRY0X2OFh2cIvfiqh4=');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  color: #1f2937;
}
.logo-text {
  font-family: 'Times New Roman', serif;
  font-size: 1.2rem;
  font-weight: bold;
  color: #facc15;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}
.transparent-banner {
  background: rgba(10, 100, 90, 0.85);
  backdrop-filter: blur(3px);
}
/* Menu hamburguesa */
.menu-icon { font-size: 28px; cursor: pointer; user-select: none; color: white; }
@media (min-width: 768px) { .menu-icon { display: none; } }
nav ul { list-style: none; padding: 0; margin: 0; }
@media (max-width: 767px) {
  nav ul {
    flex-direction: column;
    background: rgba(0,0,0,0.85);
    position: absolute;
    top: 60px;
    right: 0;
    width: 200px;
    padding: 1rem 0;
    border-top: 1px solid #facc15;
    display: none;
    z-index: 40;
  }
  nav ul li { margin: 0.5rem 0; text-align: center; }
}
/* Dropdown perfil */
.profile-container { position: relative; }
.profile-dropdown {
  display: none;
  position: absolute;
  right: 0;
  top: 100%;
  background-color: white;
  border-radius: 0.5rem;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  min-width: 160px;
  z-index: 50;
  flex-direction: column;
}
.profile-dropdown a, .profile-dropdown button {
  padding: 0.5rem 1rem;
  text-align: left;
  width: 100%;
  color: #1f2937;
  text-decoration: none;
  font-size: 0.9rem;
}
.profile-dropdown a:hover, .profile-dropdown button:hover {
  background-color: #facc15;
  color: #1f2937;
}
#card-number-container { position: relative; }
#card-type {
  position: absolute;
  right: 1rem;
  top: 50%;
  transform: translateY(-50%);
  width: 40px;
  height: 26px;
  pointer-events: none;
  user-select: none;
  opacity: 0;
  transition: opacity 0.3s ease;
}
#card-type img { width: 100%; height: auto; display: block; }
#card-type.visible { opacity: 1; }
</style>
</head>
<body class="text-gray-800">

<!-- Navbar -->
<header id="main-header" class="fixed top-0 left-0 w-full z-50 bg-transparent transition-colors duration-300">
<nav class="flex flex-wrap justify-between items-center px-4 md:px-6 py-4 text-white relative">
  <div class="logo-text">Capt. Wayne</div>

  <!-- Icono hamburguesa -->
  <div class="menu-icon ml-auto" id="menu-btn">&#9776;</div>

  <!-- Menú -->
  <ul id="menu" class="md:flex md:items-center space-x-4 hidden">
    <li><a href="index.html" class="hover:text-yellow-300 transition">Inicio</a></li>
    <li><a href="tours.html" class="hover:text-yellow-300 transition">Tours</a></li>
    <li><a href="galeria.html" class="hover:text-yellow-300 transition">Galería</a></li>
    <li><a href="mapa.html" class="hover:text-yellow-300 transition">Mapa</a></li>
    <li><a href="sobrenosotros.html" class="hover:text-yellow-300 transition">Sobre Nosotros</a></li>
    <li><a href="misreservas.html" class="hover:text-yellow-300 transition">Mis Reservas</a></li>
    <li><a href="contacto.html" class="hover:text-yellow-300 transition">Contacto</a></li>
    <li><a href="calendario.html" class="hover:text-yellow-300 transition">Calendario</a></li>
    <li>
      <a href="carrito.html" class="relative flex items-center hover:text-yellow-400 transition">
        🛒 <span class="ml-1">Carrito</span>
        <span id="cart-count" class="ml-1 bg-yellow-400 text-xs text-black px-2 py-0.5 rounded-full">0</span>
      </a>
    </li>
    <!-- Perfil -->
    <li class="profile-container">
      <button id="profile-toggle" class="profile-btn" aria-haspopup="true" aria-expanded="false" title="Perfil de Usuario">
        <svg viewBox="0 0 64 64" width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="32" cy="32" r="30" stroke="currentColor" stroke-width="4"/>
          <circle cx="32" cy="22" r="8" stroke="currentColor" stroke-width="4" fill="none"/>
          <path d="M12 48c4-8 12-12 20-12s16 4 20 12" stroke="currentColor" stroke-width="4" fill="none" stroke-linecap="round"/>
        </svg>
      </button>
      <div id="profile-dropdown" class="profile-dropdown flex flex-col">
        <a href="perfil.html">Mi perfil</a>
        <a href="misreservas.html">Mis reservas</a>
        <a href="configuracion.html">Configuración</a>
        <button id="logout-btn">Cerrar sesión</button>
      </div>
    </li>
  </ul>
</nav>
</header>

<!-- Título -->
<section class="transparent-banner text-white py-20 px-4 md:px-6 text-center shadow-md mt-20 rounded-lg mx-6 md:mx-20">
  <h1 class="text-4xl font-extrabold tracking-tight">Tu Carrito de Compras</h1>
  <p class="text-lg mt-2 text-white/90">Revisa los tours que quieres reservar</p>
</section>

<!-- Tabla de Carrito -->
<section class="py-12 px-4 md:px-20 mx-6 md:mx-20 rounded-lg shadow-lg" aria-label="Tabla de tours en el carrito">
  <table class="min-w-full bg-white rounded-lg overflow-hidden">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Tour</th>
        <th class="px-4 py-3 text-center text-sm font-semibold text-gray-700">Precio</th>
        <th class="px-4 py-3 text-center text-sm font-semibold text-gray-700">Cantidad</th>
        <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Subtotal</th>
        <th class="px-4 py-3"></th>
      </tr>
    </thead>
    <tbody id="cart-items">
      <tr><td colspan="5" class="text-center py-4">El carrito está vacío.</td></tr>
    </tbody>
  </table>

  <div class="mt-8 max-w-md ml-auto">
    <div class="flex justify-between text-lg font-semibold">
      <span>Total:</span>
      <span id="cart-total" aria-live="polite">$0.00</span>
    </div>
    <button id="checkout" class="mt-4 w-full bg-yellow-400 text-gray-900 py-3 rounded-full font-semibold hover:bg-yellow-300 transition">
      Proceder al Pago
    </button>
    <button id="vaciar-carrito" class="mt-2 w-full bg-red-500 text-white py-3 rounded-full font-semibold hover:bg-red-600 transition">
      Vaciar Carrito
    </button>
  </div>
</section>

<!-- Formulario de Pago -->
<section id="payment-form" class="hidden py-12 px-4 md:px-20 bg-gray-50 mx-6 md:mx-20 rounded-lg shadow-lg" aria-hidden="true">
  <div class="max-w-lg mx-auto bg-white p-8 rounded-xl shadow-lg">
    <h2 class="text-2xl font-bold text-teal-700 mb-6 text-center">Datos de Pago</h2>
    <form id="form-pago" class="space-y-4">
      <div>
        <label class="block text-gray-700 mb-1" for="name">Nombre Completo</label>
        <input type="text" id="name" class="w-full px-4 py-2 border rounded" placeholder="Tu nombre" required />
      </div>
      <div>
        <label class="block text-gray-700 mb-1" for="email">Correo Electrónico</label>
        <input type="email" id="email" class="w-full px-4 py-2 border rounded" placeholder="ejemplo@correo.com" required />
      </div>
      <div id="card-number-container">
        <label class="block text-gray-700 mb-1" for="card-number">Número de Tarjeta</label>
        <input type="text" id="card-number" class="w-full px-4 py-2 border rounded" placeholder="1234 5678 9012 3456" required autocomplete="off" aria-describedby="card-type" />
        <span id="card-type" aria-label="Tipo de tarjeta"></span>
      </div>
      <div class="flex space-x-4">
        <div class="w-1/2">
          <label class="block text-gray-700 mb-1" for="expiry">Expiración (MM/AA)</label>
          <input type="text" id="expiry" class="w-full px-4 py-2 border rounded" placeholder="08/25" required />
        </div>
        <div class="w-1/2">
          <label class="block text-gray-700 mb-1" for="cvc">CVC/CVV</label>
          <input type="text" id="cvc" class="w-full px-4 py-2 border rounded" placeholder="123" required />
        </div>
      </div>
      <div>
        <label class="block text-gray-700 mb-1" for="address">Dirección de Facturación</label>
        <input type="text" id="address" class="w-full px-4 py-2 border rounded" placeholder="Calle, Ciudad, País" required />
      </div>
      <button type="submit" class="w-full bg-teal-700 text-white py-3 rounded-full font-semibold hover:bg-teal-600 transition mt-4">
        Confirmar Reserva
      </button>
    </form>
  </div>
</section>

<!-- Footer -->
<footer class="bg-gray-100 text-gray-700 text-center py-6 mt-12 rounded-lg mx-6 md:mx-20">
<p class="text-sm">&copy; 2025 Capt. Wayne Charters. Todos los derechos reservados.</p>
</footer>

<!-- Scripts -->
<script>
// Scroll header
const header = document.getElementById('main-header');
window.addEventListener('scroll', () => {
  if (window.scrollY > 50) {
    header.classList.remove('bg-transparent');
    header.classList.add('bg-black', 'bg-opacity-30');
  } else {
    header.classList.add('bg-transparent');
    header.classList.remove('bg-black','bg-opacity-30');
  }
});

// Menu hamburguesa funcional
const menuBtn = document.getElementById("menu-btn");
const menu = document.getElementById("menu");
menuBtn.addEventListener("click", () => {
  if(menu.style.display === "flex") {
    menu.style.display = "none";
  } else {
    menu.style.display = "flex";
  }
});

// Dropdown perfil
const profileBtn = document.getElementById("profile-toggle");
const profileDropdown = document.getElementById("profile-dropdown");
profileBtn.addEventListener("click", e=>{
  e.stopPropagation();
  profileDropdown.style.display = profileDropdown.style.display==="flex"?"none":"flex";
});
document.addEventListener("click",()=>{ profileDropdown.style.display="none"; });

// Carrito
const cartItemsContainer = document.getElementById('cart-items');
const cartCount = document.getElementById('cart-count');
const cartTotalEl = document.getElementById('cart-total');
const checkoutBtn = document.getElementById('checkout');
const vaciarBtn = document.getElementById('vaciar-carrito');
const paymentFormSection = document.getElementById('payment-form');
const paymentForm = document.getElementById('form-pago');

function loadCart(){
  const cart = JSON.parse(localStorage.getItem('cart'))||[];
  cartItemsContainer.innerHTML='';
  if(cart.length===0){
    cartItemsContainer.innerHTML='<tr><td colspan="5" class="text-center py-4">El carrito está vacío.</td></tr>';
    cartTotalEl.innerText='$0.00';
    cartCount.innerText='0';
    return;
  }
  cart.sort((a,b)=>a.title.localeCompare(b.title));
  cart.forEach(item=>{
    const subtotal = item.price*item.quantity;
    const row = document.createElement('tr');
    row.classList.add('border-b'); row.dataset.id=item.id;
    row.innerHTML=`
      <td class="px-4 py-3 flex items-center gap-4">
        <img src="${item.image}" alt="${item.title}" class="w-16 h-16 object-cover rounded"/>
        <div>
          <div class="font-semibold">${item.title}</div>
          <div class="text-gray-600 text-sm">${item.description}</div>
        </div>
      </td>
      <td class="px-4 py-3 text-center">$${item.price.toFixed(2)}</td>
      <td class="px-4 py-3 text-center">
        <input type="number" min="1" value="${item.quantity}" class="qty w-16 px-2 py-1 border rounded text-center"/>
      </td>
      <td class="px-4 py-3 text-right subtotal">$${subtotal.toFixed(2)}</td>
      <td class="px-4 py-3 text-center">
        <button class="remove text-red-500 hover:underline cursor-pointer">Eliminar</button>
      </td>`;
    cartItemsContainer.appendChild(row);
  });
  updateCart();
}

function updateCart(){
  let total=0;
  const rows=cartItemsContainer.querySelectorAll('tr');
  rows.forEach(row=>{
    const price=parseFloat(row.querySelector('td:nth-child(2)').innerText.replace('$',''));
    const qty=parseInt(row.querySelector('.qty').value,10);
    const subtotal=price*qty;
    row.querySelector('.subtotal').innerText='$'+subtotal.toFixed(2);
    total+=subtotal;
  });
  cartTotalEl.innerText='$'+total.toFixed(2);
  cartCount.innerText=rows.length;
  saveCart();
}

function saveCart(){
  const rows=cartItemsContainer.querySelectorAll('tr');
  const cart=[];
  rows.forEach(row=>{
    const id=row.dataset.id;
    const title=row.querySelector('.font-semibold').innerText;
    const description=row.querySelector('.text-gray-600')?.innerText||'';
    const price=parseFloat(row.querySelector('td:nth-child(2)').innerText.replace('$',''));
    const quantity=parseInt(row.querySelector('.qty').value,10);
    const image=row.querySelector('td img').src;
    cart.push({id,title,description,price,quantity,image});
  });
  localStorage.setItem('cart',JSON.stringify(cart));
  cartCount.innerText=cart.length;
}

cartItemsContainer.addEventListener('input', e=>{
  if(e.target.classList.contains('qty')){
    if(parseInt(e.target.value)<1) e.target.value=1;
    updateCart();
  }
});
cartItemsContainer.addEventListener('click', e=>{
  if(e.target.classList.contains('remove')){
    e.target.closest('tr').remove();
    updateCart();
  }
});

checkoutBtn.addEventListener('click', ()=>{
  if(cartItemsContainer.children.length===0){
    alert('El carrito está vacío. Agrega tours antes de proceder al pago.');
    return;
  }
  paymentFormSection.classList.remove('hidden');
  paymentFormSection.setAttribute('aria-hidden','false');
  window.scrollTo({top: paymentFormSection.offsetTop-80, behavior:'smooth'});
});

vaciarBtn.addEventListener('click', ()=>{
  if(confirm('¿Deseas vaciar el carrito?')){
    localStorage.removeItem('cart');
    loadCart();
  }
});

paymentForm.addEventListener('submit', e=>{
  e.preventDefault();
  alert('¡Reserva realizada con éxito!');
  localStorage.removeItem('cart');
  loadCart();
  paymentFormSection.classList.add('hidden');
  paymentFormSection.setAttribute('aria-hidden','true');
  paymentForm.reset();
});

loadCart();
</script>
</body>
</html>
